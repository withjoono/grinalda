âœ… Connected to database

ğŸ“‹ Step 0: Backing up existing member data...
  Found 11 members
  Backup saved to scripts/auth_member_backup.json

ğŸ”„ Transaction started

ğŸ“‹ Step 1: Dropping FK constraints referencing auth_member.id...
  Dropping: susi_user_calculated_scores -> FK_5fccc51f65c1c6243bace2ee5dc
  Dropping: oauth_authorization_codes -> FK_bb52972ac16d079e6a01bd8a0d9
  Dropping: hub_app_subscriptions -> FK_fa0bc8fea3c4ad3bfd9a7a40c61
  Dropping: ss_user_university_interest -> FK_cdf5cf768b3ee23bbda3a4cd6c8
  Dropping: sgb_attendance -> FK_ab59aa77602dc12798ab0b69515
  Dropping: sgb_select_subject -> FK_895cc243212db9f5298e8777f98
  Dropping: sgb_subject_learning -> FK_ce1cf4720081289de7af738f634
  Dropping: sgb_volunteer -> FK_a48ca7f5c57fd7c0e20233b58f2
  Dropping: js_sunung_raw_score -> FK_412956dba58c49fd8d47e30ae83
  Dropping: js_sunung_standard_score -> FK_0d351b77ee253a29d724d60ba57
  Dropping: js_pyunggawon_raw_score -> FK_42c5765cfa70f470b423bdad7d9
  Dropping: sgb_sport_art -> FK_13c46e6db4bdb6442527a047bbc
  Dropping: board_comment -> FK_1954cb2d7b04c7f5ac7e37a567f
  Dropping: board_post -> FK_c13843522283316f88d6186b29b
  Dropping: ss_user_application_combination -> FK_b47f710b6a70bdcd521d214184b
  Dropping: js_user_university_interest -> FK_5e944b036e7505e8900725a0ca6
  Dropping: officer_list_tb -> FK_66031c9b22af5d481c5e8fe818a
  Dropping: payment_order -> FK_10f7699146806847bfaf02f0870
  Dropping: js_user_application_combination -> FK_282b1614c856f0c500ad776d4e9
  Dropping: js_user_calculated_scores -> FK_10ba97ef5c7898ac224120727d0
  Dropping: js_user_input_scores -> FK_6649936a2651ff1b6a45947fc76
  Dropping: js_user_recruitment_scores -> FK_909c2374500015390bbb21f2179
  Dropping: js_user_hwansan_score -> FK_d49850ff8a7c2f94684e92c4d2f
  Dropping: tr_temp_code -> FK_0e279bc9320051f700f82bb1243
  Dropping: tr_account_link -> FK_171c6be83c1de2061e8a6c60f2d
  Dropping: tr_account_link -> FK_e75210ba27c039f94429d6ce9c0
  Dropping: tr_admin_class -> FK_db86b298af108d230047279d819
  Dropping: tr_admin_class -> FK_28def87749e7bf7b467044f673e
  Dropping: pl_plan -> FK_44e16926b52c101023b64c2f7b8
  Dropping: pl_item -> FK_54f0b02de06c4bd92da4146ec0c
  Dropping: pl_routine -> FK_bfe4f517e4c50ec56fcefe1530d
  Dropping: pl_class -> FK_1e6c060e6c7a786289de5da1780
  Dropping: pl_management -> FK_9c645fa42f089307954fb39cb01
  Dropping: pl_management -> FK_dcf917538ec0b5bbefb4316283c
  Dropping: pl_notice -> FK_d6c78af73f08d3de0a92194bcfc
  Dropping: mc_health_record -> FK_2d45e4d3095409736862c61d951
  Dropping: mc_consultation -> FK_e9d3791cd6d186a15b41f262254
  Dropping: mc_consultation -> FK_102d71225d0d53f4b1d4ae3b321
  Dropping: mc_attendance -> FK_54228e7fd0f296b0f5486307e20
  Dropping: mc_test -> FK_a7fd75e8d0fc82818103bc050c7
  Dropping: user_notification_settings -> FK_afde2b06a492db472bbd4aadb1c
  Dropping: user_notification_types -> FK_01517d266ced6776219af0e67d8
  Dropping: notification_logs -> FK_3f72c6d70ef5e45a8dd590e2389
  Dropping: mentoring_temp_code_tb -> FK_mentoring_temp_code_member
  Dropping: mentoring_account_link_tb -> FK_mentoring_link_member
  Dropping: mentoring_account_link_tb -> FK_mentoring_link_linked_member
  Dropping: ts_member_calculated_scores -> FK_32847f17ce765449b628fb1e1a4
  Dropping: ts_member_jungsi_input_scores -> FK_a9c19ddc128bad93787d9bdb036
  Dropping: susi_user_recruitment_scores -> FK_4b1de013d2c58e27fc7f91320e7
  Dropped 49 FK constraints

ğŸ“‹ Step 2: Dropping PK, unique constraints, and indexes on auth_member...
  Dropped UNIQUE: UQ_2f18d1b77549349961f8bf5a3a1
  Dropped PRIMARY KEY: PK_ec4590e3645c1568c75c9cdc0c0
  Dropped index: IDX_2f18d1b77549349961f8bf5a3a
  Dropped index: idx_member_firebase_uid
  Dropped id default (sequence)

ğŸ“‹ Step 3: Changing auth_member.id from bigint to varchar(30)...
  Changed auth_member.id to varchar(30)
  Re-added PK on auth_member.id

ğŸ“‹ Step 4: Converting existing IDs to new format...
  1 -> LEGACY000001
  10 -> LEGACY000010
  17 -> LEGACY000017
  18 -> LEGACY000018
  2 -> LEGACY000002
  3 -> LEGACY000003
  4 -> LEGACY000004
  6 -> LEGACY000006
  7 -> LEGACY000007
  8 -> LEGACY000008
  9 -> LEGACY000009

ğŸ“‹ Step 5: Changing FK reference columns to varchar(30)...
  âœ“ susi_user_calculated_scores.member_id
  âœ“ oauth_authorization_codes.memberId
  âœ“ hub_app_subscriptions.member_id
  âœ“ ss_user_university_interest.member_id
  âœ“ sgb_attendance.member_id
  âœ“ sgb_select_subject.member_id
  âœ“ sgb_subject_learning.member_id
  âœ“ sgb_volunteer.member_id
  âœ“ js_sunung_raw_score.member_id
  âœ“ js_sunung_standard_score.member_id
  âœ“ js_pyunggawon_raw_score.member_id
  âœ“ sgb_sport_art.member_id
  âœ“ board_comment.member_id
  âœ“ board_post.member_id
  âœ“ ss_user_application_combination.member_id
  âœ“ js_user_university_interest.member_id
  âœ“ officer_list_tb.member_id
  âœ“ payment_order.member_id
  âœ“ js_user_application_combination.member_id
  âœ“ js_user_calculated_scores.member_id
  âœ“ js_user_input_scores.member_id
  âœ“ js_user_recruitment_scores.member_id
  âœ“ js_user_hwansan_score.member_id
  âœ“ tr_temp_code.member_id
  âœ“ tr_account_link.member_id
  âœ“ tr_account_link.linked_member_id
  âœ“ tr_admin_class.member_id
  âœ“ tr_admin_class.target_member_id
  âœ“ pl_plan.member_id
  âœ“ pl_item.member_id
  âœ“ pl_routine.member_id
  âœ“ pl_class.planner_id
  âœ“ pl_management.member_id
  âœ“ pl_management.planner_id
  âœ“ pl_notice.planner_id
  âœ“ mc_health_record.member_id
  âœ“ mc_consultation.member_id
  âœ“ mc_consultation.mentor_id
  âœ“ mc_attendance.member_id
  âœ“ mc_test.member_id
  âœ“ user_notification_settings.member_id
  âœ“ user_notification_types.member_id
  âœ“ notification_logs.member_id
  âœ“ mentoring_temp_code_tb.member_id
  âœ“ mentoring_account_link_tb.member_id
  âœ“ mentoring_account_link_tb.linked_member_id
  âœ“ ts_member_calculated_scores.member_id
  âœ“ ts_member_jungsi_input_scores.member_id
  âœ“ susi_user_recruitment_scores.member_id

ğŸ“‹ Step 6: Re-creating FK constraints...
  âœ“ FK_susi_user_calculated_scores_member_id_auth_member
  âœ“ FK_oauth_authorization_codes_memberId_auth_member
  âœ“ FK_hub_app_subscriptions_member_id_auth_member
  âœ“ FK_ss_user_university_interest_member_id_auth_member
  âœ“ FK_sgb_attendance_member_id_auth_member
  âœ“ FK_sgb_select_subject_member_id_auth_member
  âœ“ FK_sgb_subject_learning_member_id_auth_member
  âœ“ FK_sgb_volunteer_member_id_auth_member
  âœ“ FK_js_sunung_raw_score_member_id_auth_member
  âœ“ FK_js_sunung_standard_score_member_id_auth_member
  âœ“ FK_js_pyunggawon_raw_score_member_id_auth_member
  âœ“ FK_sgb_sport_art_member_id_auth_member
  âœ“ FK_board_comment_member_id_auth_member
  âœ“ FK_board_post_member_id_auth_member
  âœ“ FK_ss_user_application_combination_member_id_auth_member
  âœ“ FK_js_user_university_interest_member_id_auth_member
  âœ“ FK_officer_list_tb_member_id_auth_member
  âœ“ FK_payment_order_member_id_auth_member
  âœ“ FK_js_user_application_combination_member_id_auth_member
  âœ“ FK_js_user_calculated_scores_member_id_auth_member
  âœ“ FK_js_user_input_scores_member_id_auth_member
  âœ“ FK_js_user_recruitment_scores_member_id_auth_member
  âœ“ FK_js_user_hwansan_score_member_id_auth_member
  âœ“ FK_tr_temp_code_member_id_auth_member
  âœ“ FK_tr_account_link_member_id_auth_member
  âœ“ FK_tr_account_link_linked_member_id_auth_member
  âœ“ FK_tr_admin_class_member_id_auth_member
  âœ“ FK_tr_admin_class_target_member_id_auth_member
  âœ“ FK_pl_plan_member_id_auth_member
  âœ“ FK_pl_item_member_id_auth_member
  âœ“ FK_pl_routine_member_id_auth_member
  âœ“ FK_pl_class_planner_id_auth_member
  âœ“ FK_pl_management_member_id_auth_member
  âœ“ FK_pl_management_planner_id_auth_member
  âœ“ FK_pl_notice_planner_id_auth_member
  âœ“ FK_mc_health_record_member_id_auth_member
  âœ“ FK_mc_consultation_member_id_auth_member
  âœ“ FK_mc_consultation_mentor_id_auth_member
  âœ“ FK_mc_attendance_member_id_auth_member
  âœ“ FK_mc_test_member_id_auth_member
  âœ“ FK_user_notification_settings_member_id_auth_member
  âœ“ FK_user_notification_types_member_id_auth_member
  âœ“ FK_notification_logs_member_id_auth_member
  âœ“ FK_mentoring_temp_code_tb_member_id_auth_member
  âœ“ FK_mentoring_account_link_tb_member_id_auth_member
  âœ“ FK_mentoring_account_link_tb_linked_member_id_auth_member
  âœ“ FK_ts_member_calculated_scores_member_id_auth_member
  âœ“ FK_ts_member_jungsi_input_scores_member_id_auth_member
  âœ“ FK_susi_user_recruitment_scores_member_id_auth_member

ğŸ“‹ Step 7: Adding missing columns to auth_member...
  Added: user_type_code (varchar(5))
  Added: user_type_detail_code (varchar(5))
  Added: reg_year (int)
  Added: reg_month (varchar(2))
  Added: reg_day (varchar(2))

ğŸ“‹ Step 8: Creating sub-profile tables...
  Created: auth_member_s (í•™ìƒ í”„ë¡œí•„)
  Created: auth_member_t (êµì‚¬ í”„ë¡œí•„)
  Created: auth_member_p (í•™ë¶€ëª¨ í”„ë¡œí•„)

ğŸ“‹ Step 9: Recreating indexes...
  Created: IDX_auth_member_email_phone_oauth
  Created: idx_member_firebase_uid

ğŸ“‹ Step 10: Dropping unused sequence...
  Dropped: auth_member_id_seq

âœ… Migration completed successfully!

ğŸ“‹ Verification:
  id=LEGACY000001 | type=character varying
  id=LEGACY000010 | type=character varying
  id=LEGACY000017 | type=character varying
  Table exists: auth_member_s
  Table exists: auth_member_t
  Table exists: auth_member_p
  âœ… VARCHAR ID insert: SUCCESS
  (rolled back test insert)